<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp Multi-Canais - Sistema Pixel12</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f8f9fa; }
        .navbar { background: #25D366; color: white; padding: 15px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .navbar h1 { text-align: center; font-size: 24px; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.08); }
        .card h3 { color: #333; margin-bottom: 15px; font-size: 18px; }
        .stats { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
        .stat { text-align: center; padding: 15px; background: #f8f9fa; border-radius: 10px; }
        .stat-number { font-size: 24px; font-weight: bold; color: #25D366; }
        .stat-label { color: #666; font-size: 14px; margin-top: 5px; }
        .btn { background: #25D366; color: white; padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; transition: all 0.3s; }
        .btn:hover { background: #128C7E; transform: translateY(-2px); }
        .section { margin-bottom: 30px; }
        .section h2 { color: #333; margin-bottom: 20px; font-size: 22px; border-bottom: 2px solid #25D366; padding-bottom: 10px; }
        .status { padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; }
        .online { background: #28a745; color: white; }
        .offline { background: #dc3545; color: white; }
        .loading { text-align: center; color: #666; padding: 20px; }
    </style>
</head>
<body>
    <nav class="navbar">
        <h1>ðŸš€ WhatsApp Multi-Canais - Sistema Pixel12</h1>
    </nav>
    
    <div class="container">
        <!-- Dashboard Principal -->
        <div class="dashboard">
            <div class="card">
                <h3>ðŸ“Š Status do Sistema</h3>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-number" id="system-status">ONLINE</div>
                        <div class="stat-label">Sistema</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number" id="uptime">--</div>
                        <div class="stat-label">Uptime</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>ðŸ‘¥ UsuÃ¡rios</h3>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-number" id="users-count">--</div>
                        <div class="stat-label">Total</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number" id="users-active">--</div>
                        <div class="stat-label">Ativos</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>ðŸ“± WhatsApp</h3>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-number" id="sessions-count">--</div>
                        <div class="stat-label">SessÃµes</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number" id="messages-count">--</div>
                        <div class="stat-label">Mensagens</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>ðŸ’¼ NegÃ³cios</h3>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-number" id="clients-count">--</div>
                        <div class="stat-label">Clientes</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number" id="projects-count">--</div>
                        <div class="stat-label">Projetos</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- SeÃ§Ã£o WhatsApp -->
        <div class="section">
            <h2>ï¿½ï¿½ GestÃ£o WhatsApp</h2>
            <div class="card">
                <h3>SessÃµes Ativas</h3>
                <div id="sessions-list" class="loading">Carregando sessÃµes...</div>
                <button class="btn" onclick="loadSessions()">ðŸ”„ Atualizar SessÃµes</button>
            </div>
        </div>
        
        <!-- SeÃ§Ã£o GestÃ£o -->
        <div class="section">
            <h2>ï¿½ï¿½ GestÃ£o Empresarial</h2>
            <div class="card">
                <h3>Clientes</h3>
                <div id="clients-list" class="loading">Carregando clientes...</div>
                <button class="btn" onclick="loadClients()">ï¿½ï¿½ Atualizar Clientes</button>
            </div>
        </div>
    </div>
    
    <script>
        // Carregar dados ao iniciar
        window.onload = function() {
            loadSystemStatus();
            loadUsers();
            loadSessions();
            loadClients();
        };
        
        // Status do sistema
        async function loadSystemStatus() {
            try {
                const response = await fetch('/health');
                const data = await response.json();
                document.getElementById('system-status').textContent = 'ONLINE';
                document.getElementById('uptime').textContent = Math.floor(data.uptime / 3600) + 'h';
            } catch (error) {
                document.getElementById('system-status').textContent = 'OFFLINE';
                document.getElementById('uptime').textContent = '--';
            }
        }
        
        // Carregar usuÃ¡rios
        async function loadUsers() {
            try {
                const response = await fetch('/api/users');
                const data = await response.json();
                document.getElementById('users-count').textContent = data.data.length;
                document.getElementById('users-active').textContent = data.data.length;
            } catch (error) {
                document.getElementById('users-count').textContent = '--';
                document.getElementById('users-active').textContent = '--';
            }
        }
        
        // Carregar sessÃµes
        async function loadSessions() {
            try {
                const response = await fetch('/api/sessions');
                const data = await response.json();
                document.getElementById('sessions-count').textContent = data.data.length;
                document.getElementById('messages-count').textContent = '0';
                
                const sessionsList = document.getElementById('sessions-list');
                if (data.data.length > 0) {
                    sessionsList.innerHTML = data.data.map(session => `
                        <div style="padding: 10px; margin: 5px 0; background: #f8f9fa; border-radius: 8px;">
                            <strong>${session.session_name}</strong><br>
                            ðŸ“± ${session.phone_number}<br>
                            <span class="status ${session.status === 'connected' ? 'online' : 'offline'}">${session.status}</span>
                        </div>
                    `).join('');
                } else {
                    sessionsList.innerHTML = '<p>Nenhuma sessÃ£o encontrada</p>';
                }
            } catch (error) {
                document.getElementById('sessions-list').innerHTML = '<p>Erro ao carregar sessÃµes</p>';
            }
        }
        
        // Carregar clientes
        async function loadClients() {
            try {
                const response = await fetch('/api/clients');
                const data = await response.json();
                document.getElementById('clients-count').textContent = data.data ? data.data.length : '0';
                document.getElementById('projects-count').textContent = '0';
                
                const clientsList = document.getElementById('clients-list');
                if (data.data && data.data.length > 0) {
                    clientsList.innerHTML = data.data.map(client => `
                        <div style="padding: 10px; margin: 5px 0; background: #f8f9fa; border-radius: 8px;">
                            <strong>${client.name}</strong><br>
                            ðŸ“§ ${client.email || 'N/A'}<br>
                            ðŸ“± ${client.phone || 'N/A'}<br>
                            <span class="status ${client.status === 'active' ? 'online' : 'offline'}">${client.status}</span>
                        </div>
                    `).join('');
                } else {
                    clientsList.innerHTML = '<p>Nenhum cliente encontrado</p>';
                }
            } catch (error) {
                document.getElementById('clients-list').innerHTML = '<p>Erro ao carregar clientes</p>';
            }
        }
    </script>
</body>
</html>
